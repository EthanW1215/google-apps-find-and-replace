{"files":[{"id":"5f6c899b-e76c-47d5-b64b-12ee7f182190","name":"Code","type":"server_js","source":"function showPrompt() {\n  var ui \u003d SpreadsheetApp.getUi();\n  \n  ui.alert(\"Hello, fellow Kiski Area AP Statistics Student! This program is designed to automatically fill in survey participant\u0027s names on your survey template.\\n \\n\" +\n            \"You can find the tutorial here: (Youtube Link)\\n \\n\" +\n            \"(Designed by Ethan Weightman)\\n \\n\",\n            ui.ButtonSet.YES_NO);\n  \n  var result \u003d ui.prompt(\n    \"Now, enter the link to your Google Doc which contains your survey:\",\n      ui.ButtonSet.OK_CANCEL); \n\n  document1 \u003d result.getResponseText();\n  doMerge();\n}\n\nfunction doMerge() {\n  var selectedTemplateId \u003d document1;\n  \n  var templateFile \u003d DriveApp.getFileById(selectedTemplateId);\n  var mergedFile \u003d templateFile.makeCopy();\n  mergedFile.setName(\"Filled \"+templateFile.getName());\n  var mergedDoc \u003d DocumentApp.openById(mergedFile.getId());\n  var bodyElement \u003d mergedDoc.getBody();\n  var bodyCopy \u003d bodyElement.copy();\n  \n  bodyElement.clear();\n  \n  var sheet \u003d SpreadsheetApp.getActiveSheet();\n\n  var rows \u003d sheet.getDataRange();\n  var numRows \u003d rows.getNumRows();\n  var values \u003d rows.getValues();\n  var fieldNames \u003d values[0];\n\n  for (var i \u003d 1; i \u003c numRows; i++) { \n    var row \u003d values[i];\n    var body \u003d bodyCopy.copy();\n    \n    for (var f \u003d 0; f \u003c fieldNames.length; f++) {\n      body.replaceText(\"\\\\[\" + fieldNames[f] + \"\\\\]\", row[f]);\n    }\n    \n    var numChildren \u003d body.getNumChildren();\n   \n    for (var c \u003d 0; c \u003c numChildren; c++) {\n      var child \u003d body.getChild(c);\n      child \u003d child.copy();\n      if (child.getType() \u003d\u003d DocumentApp.ElementType.HORIZONTALRULE) {\n        mergedDoc.appendHorizontalRule(child);\n      } else if (child.getType() \u003d\u003d DocumentApp.ElementType.INLINEIMAGE) {\n        mergedDoc.appendImage(child.getBlob());\n      } else if (child.getType() \u003d\u003d DocumentApp.ElementType.PARAGRAPH) {\n        mergedDoc.appendParagraph(child);\n      } else if (child.getType() \u003d\u003d DocumentApp.ElementType.LISTITEM) {\n        mergedDoc.appendListItem(child);\n      } else if (child.getType() \u003d\u003d DocumentApp.ElementType.TABLE) {\n        mergedDoc.appendTable(child);\n      } else {\n        Logger.log(\"Unknown element type: \" + child);\n      }\n   }\n    \n   mergedDoc.appendPageBreak();\n\n  }\n}\n\nfunction onOpen() {\n  SpreadsheetApp.getUi()\n      .createMenu(\u0027Custom Menu\u0027)\n      .addItem(\u0027Run program\u0027, \u0027showPrompt\u0027)\n      .addToUi();  \n};"},{"id":"ee80e80c-8046-450f-af37-3f4474a700df","name":"appsscript","type":"json","source":"{\n  \"timeZone\": \"America/New_York\",\n  \"dependencies\": {\n  },\n  \"exceptionLogging\": \"STACKDRIVER\"\n}"}]}